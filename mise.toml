[tasks]

# Install dependencies
install.description = "Install protoc and Go dependencies"
install.run = """
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
go mod tidy
"""

# Generate proto code
proto.description = "Generate Go code from proto files"
proto.run = """
mkdir -p pb
protoc --go_out=. --go-grpc_out=. proto/wadoh.proto
"""

# Build
build.description = "Build the application"
build.run = "go build -o monitor ."

# Run
run.description = "Run the application"
run.depends = ["build"]
run.run = "./monitor"
